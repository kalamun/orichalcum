<?php /* (c) Kalamun.org - GNU/GPL 3 */

require_once('../../inc/main.lib.php');
$kaOrichalcum=new kaOrichalcum();
$kaOrichalcum->init( array("check-permissions"=>false, "x-frame-options"=>"") );


//permanently delete a file
if(!empty($_POST['delete']))
{
	$filename = base64_decode($_POST['delete']);
	if(file_exists(rtrim($_SERVER['DOCUMENT_ROOT'], "/. ") . $filename))
	{
		unlink(rtrim($_SERVER['DOCUMENT_ROOT'], "/. ") . $filename);
	}
}


//move a file to quarantine
if(!empty($_POST['quarantine']))
{
	$filename = base64_decode($_POST['quarantine']);
	
	if(!file_exists('../quarantine')) mkdir('../quarantine');
	if(file_exists(rtrim($_SERVER['DOCUMENT_ROOT'], "/. ") . $filename))
	{
		rename(rtrim($_SERVER['DOCUMENT_ROOT'], "/. ") . $filename, '../quarantine/'.basename($filename).'_quarantined');
	}
}

